<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{fragments/header :: head}">
    <title>Подтверждение бронирования - РУТ Навигатор</title>
</head>
<body>
    <header th:replace="~{fragments/header :: header}"></header>

    <main class="main-content">
        <div class="container">
            <!-- Breadcrumb -->
            <div class="breadcrumb">
                <a th:href="@{/rooms}">Бронирование</a> / <a th:href="@{/rooms/{id}(id=${room.id})}" th:text="${room.number}">1125</a> / Подтверждение
            </div>

            <div class="confirmation-page">
                <div class="confirmation-card">
                    <div class="confirmation-icon success">&#10003;</div>
                    <h1>Бронирование подтверждено!</h1>
                    <p class="confirmation-message">Аудитория успешно забронирована.</p>

                    <div class="booking-details">
                        <div class="detail-row">
                            <span class="detail-label">Номер бронирования:</span>
                            <span class="detail-value" th:text="'#' + ${booking.id}">#123</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Аудитория:</span>
                            <span class="detail-value" th:text="${booking.roomDisplayName}">1125 ГУК-1</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Дата:</span>
                            <span class="detail-value" th:text="${#temporals.format(booking.bookingDate, 'dd MMMM yyyy')}">01 января 2025</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Время:</span>
                            <span class="detail-value" th:text="${booking.timeRange}">8:30 – 9:50</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Пара:</span>
                            <span class="detail-value" th:text="${booking.classPeriod.displayName}">1-я пара</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Цель:</span>
                            <span class="detail-value" th:text="${booking.purpose}">Лекция</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Статус:</span>
                            <span class="detail-value status-badge"
                                  th:classappend="${booking.status.name()}"
                                  th:text="${booking.status.displayName}">Одобрено</span>
                        </div>
                    </div>

                    <div class="confirmation-actions">
                        <a th:if="${booking.approved}" th:href="@{/booking/pdf/{id}(id=${booking.id})}"
                           class="btn btn-primary" download>
                            Скачать PDF подтверждение
                        </a>
                        <a th:href="@{/my-bookings}" class="btn btn-secondary">Все бронирования</a>
                        <a th:href="@{/rooms}" class="btn btn-outline">Забронировать ещё</a>
                    </div>
                </div>

                <!-- Room Info -->
                <div class="room-info-card">
                    <h3>Информация об аудитории</h3>
                    <p><strong>Корпус:</strong> <span th:text="${room.building}">ГУК-1</span></p>
                    <p><strong>Этаж:</strong> <span th:text="${room.floor}">1</span></p>
                    <p><strong>Вместимость:</strong> <span th:text="${room.capacity} + ' мест'">30 мест</span></p>
                    <div class="room-features">
                        <span th:if="${room.hasComputers}" class="feature-badge">Компьютеры</span>
                        <span th:if="${room.hasProjector}" class="feature-badge">Проектор</span>
                        <span th:if="${room.hasWhiteboard}" class="feature-badge">Доска</span>
                    </div>
                </div>

                <!-- Similar Rooms -->
                <div th:if="${!#lists.isEmpty(similarRooms)}" class="similar-rooms-section">
                    <h2>Может подойти</h2>
                    <div class="similar-rooms-grid">
                        <div th:each="similarRoom : ${similarRooms}" class="similar-room-card">
                            <div class="room-image">
                                <div th:if="${similarRoom.imagePath != null}" class="image-container">
                                    <img th:src="${similarRoom.imagePath}" th:alt="${similarRoom.number}">
                                </div>
                                <div th:unless="${similarRoom.imagePath != null}" class="image-placeholder">
                                    <span th:text="${similarRoom.number}">1124</span>
                                </div>
                            </div>
                            <div class="room-info">
                                <h4 th:text="${similarRoom.number}">1124</h4>
                                <p th:text="${similarRoom.capacity} + ' мест'">30 мест</p>
                                <div class="room-rating">
                                    <span class="rating-badge"
                                          th:classappend="${similarRoom.averageRating >= 4} ? 'good' : 'average'"
                                          th:text="${#numbers.formatDecimal(similarRoom.averageRating, 1, 1)}">4.0</span>
                                </div>
                                <a th:href="@{/rooms/{id}(id=${similarRoom.id})}" class="btn btn-outline btn-sm">Смотреть</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer th:replace="~{fragments/footer :: footer}"></footer>

    <script th:src="@{/js/main.js}"></script>
</body>
</html>
